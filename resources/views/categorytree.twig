{% if categories %}
<ol class="categorytree">

    {% for cat in categories %}
    <li class="category">

        {% if cat.getChildren().count() == 0 %}
        <span class="ui-icon ui-icon-arrow-1-s"></span>
        {% else %}
        <a class="ui-icon ui-icon-arrow-1-e" title="Expand this item"></a>
        {% endif %}

        <label>
            <input type="checkbox" name="category_ids[]"
                   {% if selected.contains(cat.id) %}checked{% endif %}
                   value="{{cat.id}}" />
            {{cat.name}}
        </label>

        {% if cat.description %}
        <div class="description">{{cat.description}}</div>
        {% endif %}

        {% if cat.getChildren() %}
        {{include('categorytree', {"categories":cat.getChildren()})}}
        {% endif %}

    </li>
    {% endfor %}

</ol>
{% endif %}
